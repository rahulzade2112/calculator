<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Feedback | Calculator Project</title>
  <link rel="stylesheet" href="feedback.css" />
</head>
<body>

<form id="feedbackForm">
  <label for="name">Full Name</label>
  <input type="text" id="name" required>

  <label for="email">Email</label>
  <input type="email" id="email" required>

  <label for="rating">Rate Calculator</label>
  <select id="rating" required>
    <option value="">Select Rating</option>
    <option value="5">⭐️⭐️⭐️⭐️⭐️ Excellent</option>
    <option value="4">⭐️⭐️⭐️⭐️ Good</option>
    <option value="3">⭐️⭐️⭐️ Average</option>
    <option value="2">⭐️⭐️ Poor</option>
    <option value="1">⭐️ Bad</option>
  </select>

  <label for="message">Your Feedback</label>
  <textarea id="message" rows="5" required></textarea>

  <button type="submit">Submit Feedback</button>
</form>

<script>
const form = document.getElementById("feedbackForm");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const data = {
    name: document.getElementById("name").value,
    email: document.getElementById("email").value,
    rating: document.getElementById("rating").value,
    message: document.getElementById("message").value,
  };

  try {
    // ✅ your backend route (not the same page)
    const res = await fetch("http://localhost:5001/api/feedback", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data),
    });

    const text = await res.text();
    let result;
    try {
      result = JSON.parse(text);
    } catch {
      result = { message: text || "Feedback submitted!" };
    }
    if (res.ok) {
      alert(result.message || "Thank you for your feedback!");
      form.reset();
    } else {
      throw new Error(result.message || "Server Error");
    }
  } catch (err) {
    console.error("Feedback submit error:", err);
    alert("Failed to send feedback. Please try again.");
  }
});
</script>

</body>
</html>
